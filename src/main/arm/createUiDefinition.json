{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "basics": [
            {
                "name": "basicsRequired",
                "type": "Microsoft.Common.Section",
                "label": "Credentials for WebLogic",
                "elements": [
                    {
                        "name": "wlsUserName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Username for WebLogic Administrator",
                        "defaultValue": "weblogic",
                        "toolTip": "Use only letters and numbers",
                        "constraints": {
                            "required": true,
                            "validations": [
                                {
                                    "regex": "^[a-z0-9A-Z]{1,30}$",
                                    "message": "The value must be 1-30 characters long and must only contain letters and numbers."
                                },
                                {
                                    "isValid": "[greaterOrEquals(length(basics('basicsRequired').identity.userAssignedIdentities),1)]",
                                    "message": "Please select at least one user assigned managed identity from User assigned managed identity control below."
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "wlsPassword",
                        "type": "Microsoft.Common.PasswordBox",
                        "label": {
                            "password": "Password for WebLogic Administrator",
                            "confirmPassword": "Confirm password"
                        },
                        "toolTip": "Password for WebLogic Administrator",
                        "constraints": {
                            "required": true,
                            "regex": "^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)[A-Za-z\\d]{12,}$",
                            "validationMessage": "The password must contain at least 12 characters, with at least 1 uppercase letter, 1 lowercase letter and 1 number, and special characters are not allowed."
                        },
                        "options": {
                            "hideConfirmation": false
                        },
                        "visible": true
                    },
                    {
                        "name": "wdtRuntimePassword",
                        "type": "Microsoft.Common.PasswordBox",
                        "label": {
                            "password": "Password for WebLogic Deploy Tooling runtime encrytion",
                            "confirmPassword": "Confirm password"
                        },
                        "toolTip": "The model WebLogic Deploy Tooling runtime encrytion secret.",
                        "constraints": {
                            "required": true,
                            "regex": "^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)[A-Za-z\\d]{12,}$",
                            "validationMessage": "The password must contain at least 12 characters, with at least 1 uppercase letter, 1 lowercase letter and 1 number, and special characters are not allowed."
                        },
                        "options": {
                            "hideConfirmation": false
                        },
                        "visible": true
                    },
                    {
                        "name": "ocrSSOInfo",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": true,
                        "options": {
                            "icon": "Info",
                            "text": "Provide an Oracle Single Sign-On (SSO) account to access the Oracle Registry Server. Click the link to create Oracle SSO account.",
                            "uri": "https://profile.oracle.com/myprofile/account/create-account.jspx"
                        }
                    },
                    {
                        "name": "ocrSSOUserName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Username for Oracle Single Sign-On authentication",
                        "defaultValue": "example@contoso.com",
                        "toolTip": "Username for Oracle Single Sign-On authentication to login the Oracle Container Registry.",
                        "constraints": {
                            "required": true,
                            "regex": "^([a-zA-Z0-9_\\-\\.]+)@([a-zA-Z0-9_\\-\\.]+)\\.([a-zA-Z]{2,5})$",
                            "validationMessage": "The value must be an email address."
                        },
                        "visible": true
                    },
                    {
                        "name": "ocrSSOPassword",
                        "type": "Microsoft.Common.PasswordBox",
                        "label": {
                            "password": "Password for Oracle Single Sign-On authentication",
                            "confirmPassword": "Confirm password"
                        },
                        "toolTip": "Password for Oracle Single Sign-On authentication to login the Oracle Container Registry.",
                        "constraints": {
                            "required": true,
                            "regex": "^(?=.*[A-Z])(?=.*[a-z])(?=.*\\d)[A-Za-z\\d\\$\\&\\+\\,:;\\=\\?@#|'.\\^\\*!\\-_~/'\\[\\]\\{\\}\"]{8,}$",
                            "validationMessage": "The password must contain at least 8 characters, with at least 1 uppercase letter, 1 lowercase letter and 1 number, and special characters, but should not contain > < ( ) % ; \\."
                        },
                        "options": {
                            "hideConfirmation": false
                        },
                        "visible": true
                    },
                    {
                        "name": "errInfo",
                        "type": "Microsoft.Common.InfoBox",
                        "visible": "[less(length(basics('basicsRequired').identity.userAssignedIdentities),1)]",
                        "options": {
                            "icon": "Error",
                            "text": "Please select at least one user assigned managed identity.",
                            "uri": "https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/how-to-manage-ua-identity-portal"
                        }
                    },
                    {
                        "name": "identity",
                        "type": "Microsoft.ManagedIdentity.IdentitySelector",
                        "label": "Managed Identity Configuration",
                        "toolTip": {
                            "userAssignedIdentity": "Add user assigned identities to enable the WebLogic domain deployment."
                        },
                        "defaultValue": {
                            "systemAssignedIdentity": "Off"
                        },
                        "options": {
                            "hideSystemAssignedIdentity": true,
                            "hideUserAssignedIdentity": false
                        }
                    }
                ],
                "visible": true
            },
            {
                "name": "basicsOptional",
                "type": "Microsoft.Common.Section",
                "label": "Optional Basic Configuration",
                "elements": [
                    {
                        "name": "basicsOptionalAcceptDefaults",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Accept defaults for optional configuration?",
                        "defaultValue": "Yes",
                        "toolTip": "Select 'No' to edit optional basic configuration.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Yes",
                                    "value": "false"
                                },
                                {
                                    "label": "No",
                                    "value": "true"
                                }
                            ],
                            "required": true
                        }
                    },
                    {
                        "name": "managedServerPrefix",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Name prefix for Managed Server",
                        "toolTip": "The string to prepend to the name of the managed server.",
                        "defaultValue": "managed-server",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z\\-]{3,20}$",
                            "validationMessage": "The prefix must be between 3 and 20 characters long and contain letters, numbers and -."
                        },
                        "visible": "[bool(basics('basicsOptional').basicsOptionalAcceptDefaults)]"
                    },
                    {
                        "name": "wlsDomainName",
                        "type": "Microsoft.Common.TextBox",
                        "label": "WebLogic Domain Name",
                        "toolTip": "The name of the WebLogic Domain to create.",
                        "defaultValue": "domain1",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z]{3,20}$",
                            "validationMessage": "The Domain Name must be between 3 and 20 characters long and contain letters, numbers only."
                        },
                        "visible": "[bool(basics('basicsOptional').basicsOptionalAcceptDefaults)]"
                    },
                    {
                        "name": "wlsDomainUID",
                        "type": "Microsoft.Common.TextBox",
                        "label": "WebLogic Domain UID",
                        "toolTip": "The UID of the WebLogic Domain to create.",
                        "defaultValue": "sample-domain1",
                        "constraints": {
                            "required": true,
                            "regex": "^[a-z0-9A-Z\\-]{3,20}$",
                            "validationMessage": "The Domain UID must be between 3 and 20 characters long and contain letters, numbers and -."
                        },
                        "visible": "[bool(basics('basicsOptional').basicsOptionalAcceptDefaults)]"
                    },
                    {
                        "name": "wlsClusterSize",
                        "type": "Microsoft.Common.Slider",
                        "min": 5,
                        "max": 1000,
                        "label": "Cluster size",
                        "defaultValue": 5,
                        "showStepMarkers": false,
                        "toolTip": "The maximum size of the WebLogic cluster.",
                        "constraints": {
                            "required": true
                        },
                        "visible": "[bool(basics('basicsOptional').basicsOptionalAcceptDefaults)]"
                    }
                ],
                "visible": true
            },
            {
                "name": "howToReportIssues",
                "type": "Microsoft.Common.Section",
                "label": "Report issues, get help, and share feedback",
                "elements": [
                    {
                        "name": "howToReportIssueText",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "If you encounter problems during the deployment of Oracle WebLogic Server, report them here.",
                            "link": {
                                "label": "Issue tracker",
                                "uri": "https://aka.ms/arm-oraclelinux-wls-issues"
                            }
                        }
                    },
                    {
                        "name": "howToJoinSlack",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "If you want to interact directly with the Oracle WebLogic community, join the public Slack channel named 'oracle-weblogic'.",
                            "link": {
                                "label": "Join Slack",
                                "uri": "https://aka.ms/arm-oraclelinux-wls-slack"
                            }
                        }
                    },
                    {
                        "name": "survey",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "To get free help with Azure migration from the development team, fill out this survey.",
                            "link": {
                                "label": "Take survey",
                                "uri": "https://aka.ms/wls-on-azure-survey"
                            }
                        }
                    }
                ],
                "visible": true
            },
            {
                "name": "About",
                "type": "Microsoft.Common.InfoBox",
                "options": {
                    "icon": "None",
                    "text": "Template version ${project.version}"
                },
                "visible": "[bool('${template.version.visible}')]"
            }
        ],
        "steps": [
            {
                "name": "section_aks",
                "label": "Configure AKS cluster",
                "subLabel": {
                    "preValidation": "Provide required info for AKS cluster configuration",
                    "postValidation": "Done"
                },
                "bladeTitle": "Configure AKS cluster",
                "elements": [
                    {
                        "name": "clusterInfo",
                        "type": "Microsoft.Common.Section",
                        "label": "Azure Kubernetes Service",
                        "elements": [
                            {
                                "name": "createAKSCluster",
                                "type": "Microsoft.Common.OptionsGroup",
                                "label": "Create a new AKS cluster?",
                                "defaultValue": "Yes",
                                "toolTip": "Select 'Yes' to create a new AKS cluster, or select 'No' to provide an existing AKS cluster.",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Yes",
                                            "value": "true"
                                        },
                                        {
                                            "label": "No",
                                            "value": "false"
                                        }
                                    ],
                                    "required": true
                                }
                            },
                            {
                                "name": "aksClusterSelector",
                                "type": "Microsoft.Solutions.ResourceSelector",
                                "label": "Select AKS cluster",
                                "toolTip": "Select the existing AKS cluster.",
                                "resourceType": "Microsoft.ContainerService/managedClusters",
                                "options": {
                                    "filter": {
                                        "subscription": "onBasics",
                                        "location": "onBasics"
                                    }
                                },
                                "visible": "[not(bool(steps('section_aks').clusterInfo.createAKSCluster))]"
                            },
                            {
                                "name": "aksNodeCount",
                                "type": "Microsoft.Common.Slider",
                                "min": 1,
                                "max": 1000,
                                "label": "Node count",
                                "defaultValue": 2,
                                "showStepMarkers": false,
                                "toolTip": "The number of nodes that should be created along with the cluster. You will be able to resize the cluster later",
                                "constraints": {
                                    "required": true
                                },
                                "visible": "[bool(steps('section_aks').clusterInfo.createAKSCluster)]"
                            },
                            {
                                "name": "nodeVMSizeSelector",
                                "type": "Microsoft.Compute.SizeSelector",
                                "label": "Size",
                                "toolTip": "",
                                "recommendedSizes": [
                                    "Standard_DS2_v2"
                                ],
                                "constraints": {
                                    "allowedSizes": [],
                                    "excludedSizes": [],
                                    "numAvailabilityZonesRequired": 3,
                                    "zone": "3"
                                },
                                "options": {
                                    "hideDiskTypeFilter": false
                                },
                                "osPlatform": "Linux",
                                "count": 2,
                                "visible": "[bool(steps('section_aks').clusterInfo.createAKSCluster)]"
                            },
                            {
                                "name": "enableAzureMonitoring",
                                "type": "Microsoft.Common.CheckBox",
                                "label": "Enable Azure Monitoring",
                                "visible": "[bool(steps('section_aks').clusterInfo.createAKSCluster)]"
                            },
                            {
                                "name": "enableAzureFileShare",
                                "type": "Microsoft.Common.CheckBox",
                                "label": "Create Persistent Volume using Azure File share service",
                                "visible": "[bool(steps('section_aks').clusterInfo.createAKSCluster)]"
                            }
                        ]
                    },
                    {
                        "name": "acrInfo",
                        "type": "Microsoft.Common.Section",
                        "label": "Azure Container Registry",
                        "elements": [
                            {
                                "name": "createACR",
                                "type": "Microsoft.Common.OptionsGroup",
                                "label": "Create a new ACR instance?",
                                "defaultValue": "Yes",
                                "toolTip": "Select 'Yes' to create a new ACR instance, or select 'No' to provide an existing ACR instance.",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Yes",
                                            "value": "true"
                                        },
                                        {
                                            "label": "No",
                                            "value": "false"
                                        }
                                    ],
                                    "required": true
                                }
                            },
                            {
                                "name": "acrInfo",
                                "type": "Microsoft.Common.InfoBox",
                                "visible": "[not(bool(steps('section_aks').acrInfo.createACR))]",
                                "options": {
                                    "icon": "Info",
                                    "text": "Make sure the Azure Container Registry has enabled admin user.",
                                    "uri": "https://docs.microsoft.com/en-us/azure/container-registry/container-registry-authentication#admin-account"
                                }
                            },
                            {
                                "name": "acrSelector",
                                "type": "Microsoft.Solutions.ResourceSelector",
                                "label": "Select ACR instance",
                                "toolTip": "Select the existing ACR instance.",
                                "resourceType": "Microsoft.ContainerRegistry/registries",
                                "options": {
                                    "filter": {
                                        "subscription": "onBasics",
                                        "location": "onBasics"
                                    }
                                },
                                "visible": "[not(bool(steps('section_aks').acrInfo.createACR))]"
                            }
                        ]
                    },
                    {
                        "name": "imageInfo",
                        "type": "Microsoft.Common.Section",
                        "label": "Oracle WebLogic Image",
                        "elements": [
                            {
                                "name": "fromImageText",
                                "type": "Microsoft.Common.TextBlock",
                                "visible": true,
                                "options": {
                                    "text": "This value is appended to 'container-registry.oracle.com/middleware/weblogic:' and used in the Dockerfile FROM statement. \nOracle Standard Terms and Restrictions terms must be agreed. \nClick the following link to make sure you have agree the terms and check the valid tags.",
                                    "link": {
                                        "label": "Must be a valid tag value from Oracle Container Registry",
                                        "uri": "https://aka.ms/wls-aks-fromImage-tag"
                                    }
                                }
                            },
                            {
                                "name": "fromImage",
                                "type": "Microsoft.Common.TextBox",
                                "label": "WebLogic Docker tag",
                                "defaultValue": "12.2.1.4-ol8",
                                "toolTip": "Docker tag that comes after 'container-registry.oracle.com/middleware/weblogic:' in the fromImage option to 'imagetool'.",
                                "multiLine": false,
                                "constraints": {
                                    "required": true,
                                    "validations": [
                                        {
                                            "regex": "^[a-z0-9\\-\\.]+$",
                                            "message": "Must be a valid Docker tag for WebLogic on Oracle Container Registry"
                                        }
                                    ]
                                }
                            }
                        ],
                        "visible": true
                    },
                    {
                        "name": "jeeAppInfo",
                        "type": "Microsoft.Common.Section",
                        "label": "Java EE Application",
                        "elements": [
                            {
                                "name": "uploadAppPackage",
                                "type": "Microsoft.Common.OptionsGroup",
                                "label": "Deploy your application package?",
                                "defaultValue": "Yes",
                                "toolTip": "Select 'Yes' to deploy your application, or select 'No' to deploy a default 'hello world' open liberty application.",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Yes",
                                            "value": "true"
                                        },
                                        {
                                            "label": "No",
                                            "value": "false"
                                        }
                                    ],
                                    "required": true
                                }
                            },
                            {
                                "name": "appPackageUrl",
                                "type": "Microsoft.Common.FileUpload",
                                "label": "Application package (.war,.ear)",
                                "toolTip": "The application war package to deploy.",
                                "constraints": {
                                    "required": true
                                },
                                "options": {
                                    "multiple": true,
                                    "uploadMode": "url",
                                    "openMode": "binary"
                                },
                                "visible": "[bool(steps('section_aks').jeeAppInfo.uploadAppPackage)]"
                            },
                            {
                                "name": "appReplicas",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Number of application replicas",
                                "defaultValue": "2",
                                "toolTip": "The number of application replicas to deploy.",
                                "constraints": {
                                    "required": true,
                                    "regex": "^(1|2|3|4|5)$",
                                    "validationMessage": "Number of application replicas to deploy, limit 1-5."
                                }
                            }
                        ],
                        "visible": true
                    }
                ]
            },
            {
                "name": "section_appGateway",
                "type": "Microsoft.Common.Section",
                "label": "Networking",
                "subLabel": {
                    "preValidation": "Provide required info for networking",
                    "postValidation": "Done"
                },
                "bladeTitle": "Networking",
                "elements": [
                    {
                        "name": "connectToAGText",
                        "type": "Microsoft.Common.TextBlock",
                        "visible": true,
                        "options": {
                            "text": "Selecting 'Yes' here will cause the template to provision Load Balancer service or Ingress service for WebLogic Administration Console and WebLogic cluster.",
                            "link": {
                                "label": "Learn more",
                                "uri": "https://aka.ms/arm-oraclelinux-wls-cluster-app-gateway-overview"
                            }
                        }
                    },
                    {
                        "name": "lbSVCInfo",
                        "type": "Microsoft.Common.Section",
                        "label": "Standard Load Balancer service",
                        "elements": [
                            {
                                "name": "enableLBSVC",
                                "type": "Microsoft.Common.OptionsGroup",
                                "label": "Create Standard Load Balancer services for the cluster?",
                                "defaultValue": "No",
                                "toolTip": "Select 'Yes' to create Standard Load Balancer services for the cluster.",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Yes",
                                            "value": true
                                        },
                                        {
                                            "label": "No",
                                            "value": false
                                        }
                                    ],
                                    "required": false
                                }
                            },
                            {
                                "name": "enableInternalLB",
                                "type": "Microsoft.Common.CheckBox",
                                "label": "Use Internal Load Balancer",
                                "visible": "[steps('section_appGateway').lbSVCInfo.enableLBSVC]"
                            },
                            {
                                "name": "lbSVC",
                                "type": "Microsoft.Common.EditableGrid",
                                "ariaLabel": "Enter information",
                                "label": "Standard Load Balancer service",
                                "visible": "[steps('section_appGateway').lbSVCInfo.enableLBSVC]",
                                "constraints": {
                                    "width": "Full",
                                    "rows": {
                                        "count": {
                                            "min": 1,
                                            "max": 10
                                        }
                                    },
                                    "columns": [
                                        {
                                            "id": "colName",
                                            "header": "Service name prefix",
                                            "width": "2fr",
                                            "element": {
                                                "type": "Microsoft.Common.TextBox",
                                                "placeholder": "domain1-admin-server",
                                                "constraints": {
                                                    "required": true,
                                                    "validations": [
                                                        {
                                                            "regex": "^[a-z0-9A-Z-]{1,30}$",
                                                            "message": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
                                                        }
                                                    ]
                                                }
                                            }
                                        },
                                        {
                                            "id": "colTarget",
                                            "header": "Target",
                                            "width": "2fr",
                                            "element": {
                                                "name": "dropDownTargets",
                                                "type": "Microsoft.Common.DropDown",
                                                "placeholder": "admin-server",
                                                "constraints": {
                                                    "allowedValues": [
                                                        {
                                                            "label": "admin-server",
                                                            "value": "adminServer"
                                                        },
                                                        {
                                                            "label": "cluster-1",
                                                            "value": "cluster1"
                                                        }
                                                    ],
                                                    "required": true
                                                }
                                            }
                                        },
                                        {
                                            "id": "colPort",
                                            "header": "Port",
                                            "width": "1fr",
                                            "element": {
                                                "type": "Microsoft.Common.TextBox",
                                                "placeholder": "7001",
                                                "constraints": {
                                                    "required": true,
                                                    "validations": [
                                                        {
                                                            "regex": "^[0-9]{1,5}$",
                                                            "message": "Only numbers are allowed, and the value must be 1-65535."
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    ]
                                }
                            }
                        ],
                        "visible": true
                    },
                    {
                        "name": "appgwIngress",
                        "type": "Microsoft.Common.Section",
                        "label": "Application Gateway Ingress",
                        "elements": [
                            {
                                "name": "enableAppGateway",
                                "type": "Microsoft.Common.OptionsGroup",
                                "label": "Connect to Azure Application Gateway?",
                                "defaultValue": "No",
                                "toolTip": "Select 'Yes' to create an Azure Application Gateway Ingress as the load balancer for the cluster and admin server.",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Yes",
                                            "value": true
                                        },
                                        {
                                            "label": "No",
                                            "value": false
                                        }
                                    ],
                                    "required": false
                                }
                            },
                            {
                                "name": "keyVaultText00",
                                "type": "Microsoft.Common.TextBlock",
                                "visible": "[steps('section_appGateway').appgwIngress.enableAppGateway]",
                                "options": {
                                    "text": "Choose an option for providing the TLS/SSL certificate:"
                                }
                            },
                            {
                                "name": "keyVaultText01",
                                "type": "Microsoft.Common.TextBlock",
                                "visible": "[steps('section_appGateway').appgwIngress.enableAppGateway]",
                                "options": {
                                    "text": "    ⁃ Upload a TLS/SSL certificate: Upload the pre-signed certificate now."
                                }
                            },
                            {
                                "name": "keyVaultText02",
                                "type": "Microsoft.Common.TextBlock",
                                "visible": "[steps('section_appGateway').appgwIngress.enableAppGateway]",
                                "options": {
                                    "text": "    ⁃ Identify an Azure Key Vault: The Key Vault must already contain the certificate and its password stored as secrets."
                                }
                            },
                            {
                                "name": "keyVaultText03",
                                "type": "Microsoft.Common.TextBlock",
                                "visible": "[steps('section_appGateway').appgwIngress.enableAppGateway]",
                                "options": {
                                    "text": "    ⁃ Generate a self-signed certificate: generate a self-signed certificate and apply it during deployment.",
                                    "link": {
                                        "label": "Learn more",
                                        "uri": "https://aka.ms/arm-oraclelinux-wls-cluster-app-gateway-key-vault"
                                    }
                                }
                            },
                            {
                                "name": "certificateOption",
                                "type": "Microsoft.Common.OptionsGroup",
                                "label": "Select desired TLS/SSL certificate option",
                                "defaultValue": "Generate a self-signed certificate",
                                "toolTip": "Select desired TLS/SSL certificate option",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Upload a TLS/SSL certificate",
                                            "value": "haveCert"
                                        },
                                        {
                                            "label": "Identify an Azure Key Vault",
                                            "value": "haveKeyVault"
                                        },
                                        {
                                            "label": "Generate a self-signed certificate",
                                            "value": "generateCert"
                                        }
                                    ],
                                    "required": true
                                },
                                "visible": "[steps('section_appGateway').appgwIngress.enableAppGateway]"
                            },
                            {
                                "name": "keyVaultSSLCertData",
                                "type": "Microsoft.Common.FileUpload",
                                "label": "TLS/SSL certificate(.pfx)",
                                "toolTip": "TLS/SSL certificate used for App Gateway",
                                "constraints": {
                                    "required": true,
                                    "accept": ".pfx"
                                },
                                "options": {
                                    "multiple": false,
                                    "uploadMode": "file",
                                    "openMode": "binary"
                                },
                                "visible": "[equals(steps('section_appGateway').appgwIngress.certificateOption, 'haveCert')]"
                            },
                            {
                                "name": "appGatewaySSLCertPassword",
                                "type": "Microsoft.Common.PasswordBox",
                                "label": {
                                    "password": "Password",
                                    "confirmPassword": "Confirm password"
                                },
                                "toolTip": "TLS/SSL certificate password",
                                "constraints": {
                                    "required": "[equals(steps('section_appGateway').appgwIngress.certificateOption, 'haveCert')]",
                                    "regex": "^((?=.*[0-9])(?=.*[a-z])|(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])|(?=.*[0-9])(?=.*[a-z])(?=.*[!@#$%^&*])|(?=.*[0-9])(?=.*[A-Z])(?=.*[!@#$%^&*])|(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*])).{6,128}$",
                                    "validationMessage": "The password must contain at least 6 characters, with at least 1 uppercase letter, 1 lowercase letter and 1 number."
                                },
                                "options": {
                                    "hideConfirmation": false
                                },
                                "visible": "[equals(steps('section_appGateway').appgwIngress.certificateOption, 'haveCert')]"
                            },
                            {
                                "name": "keyVaultResourceGroup",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Resource group name in current subscription containing the Key Vault",
                                "defaultValue": "",
                                "toolTip": "Use only letters and numbers",
                                "constraints": {
                                    "required": true,
                                    "regex": "^[a-z0-9A-Z.\\-_()]{0,89}([a-z0-9A-Z\\-_()]{1})$",
                                    "validationMessage": "[if(greater(length(steps('section_appGateway').appgwIngress.keyVaultResourceGroup), 90),'Resource group names only allow up to 90 characters.', 'Resource group names only allow alphanumeric characters, periods, underscores, hyphens and parenthesis and cannot end in a period.')]"
                                },
                                "visible": "[equals(steps('section_appGateway').appgwIngress.certificateOption, 'haveKeyVault')]"
                            },
                            {
                                "name": "keyVaultName",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Name of the Azure Key Vault containing secrets for the certificate for TLS/SSL Termination",
                                "defaultValue": "",
                                "toolTip": "Use only letters and numbers",
                                "constraints": {
                                    "required": true,
                                    "regex": "^(?=.{3,24}$)[a-zA-Z](([a-z0-9A-Z]*|(?:\\-[^\\-][a-z0-9A-Z]*))*)$",
                                    "validationMessage": "[if(or(greater(length(steps('section_appGateway').appgwIngress.keyVaultName), 24), less(length(steps('section_appGateway').appgwIngress.keyVaultName), 3)),'Vault name must be between 3-24 alphanumeric characters. The name must begin with a letter, end with a letter or digit, and not contain consecutive hyphens.','Vault name must only contain alphanumeric characters and dashes and cannot start with a number')]"
                                },
                                "visible": "[equals(steps('section_appGateway').appgwIngress.certificateOption, 'haveKeyVault')]"
                            },
                            {
                                "name": "keyVaultSSLCertDataSecretName",
                                "type": "Microsoft.Common.TextBox",
                                "label": "The name of the secret in the specified Key Vault whose value is the TLS/SSL certificate data",
                                "defaultValue": "",
                                "toolTip": "Use only letters and numbers",
                                "constraints": {
                                    "required": true,
                                    "regex": "^[a-z0-9A-Z]{1,30}$",
                                    "validationMessage": "The value must be 1-30 characters long and must only contain letters and numbers."
                                },
                                "visible": "[equals(steps('section_appGateway').appgwIngress.certificateOption, 'haveKeyVault')]"
                            },
                            {
                                "name": "keyVaultSSLCertPasswordSecretName",
                                "type": "Microsoft.Common.TextBox",
                                "label": "The name of the secret in the specified Key Vault whose value is the password for the TLS/SSL certificate",
                                "defaultValue": "",
                                "toolTip": "Use only letters and numbers",
                                "constraints": {
                                    "required": true,
                                    "regex": "^[a-z0-9A-Z]{1,30}$",
                                    "validationMessage": "The value must be 1-30 characters long and must only contain letters and numbers."
                                },
                                "visible": "[equals(steps('section_appGateway').appgwIngress.certificateOption, 'haveKeyVault')]"
                            },
                            {
                                "name": "servicePrincipal",
                                "type": "Microsoft.Common.PasswordBox",
                                "label": {
                                    "password": "Service Principal",
                                    "confirmPassword": "Confirm password"
                                },
                                "toolTip": "Base64 encoded JSON blob of the service principal. You can generate one with command 'az ad sp create-for-rbac --sdk-auth | base64 -w0'",
                                "constraints": {
                                    "required": true
                                },
                                "options": {
                                    "hideConfirmation": true
                                },
                                "visible": "[steps('section_appGateway').appgwIngress.enableAppGateway]"
                            },
                            {
                                "name": "appgwForAdminServer",
                                "type": "Microsoft.Common.OptionsGroup",
                                "label": "Create ingress for Administration Console. Make sure no application with path /console*, it will cause conflict with Administration Console path.",
                                "defaultValue": "Yes",
                                "toolTip": "Select 'Yes' to Create ingress for Administration Console. Make sure no application with path /console*, it will cause conflict with Administration Console path.",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Yes",
                                            "value": true
                                        },
                                        {
                                            "label": "No",
                                            "value": false
                                        }
                                    ]
                                },
                                "visible": "[steps('section_appGateway').appgwIngress.enableAppGateway]"
                            }
                        ],
                        "visible": true
                    },
                    {
                        "name": "dnsConfiguration",
                        "type": "Microsoft.Common.Section",
                        "label": "Custom DNS Configuration",
                        "elements": [
                            {
                                "name": "enableDNSConfiguration",
                                "type": "Microsoft.Common.OptionsGroup",
                                "label": "Configure Custom DNS Alias",
                                "defaultValue": "No",
                                "toolTip": "Select 'Yes' to configure Custom DNS Alias.",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Yes",
                                            "value": true
                                        },
                                        {
                                            "label": "No",
                                            "value": false
                                        }
                                    ],
                                    "required": false
                                }
                            },
                            {
                                "name": "bringDNSZone",
                                "type": "Microsoft.Common.OptionsGroup",
                                "label": "Use an existing Azure DNS Zone",
                                "defaultValue": "No",
                                "toolTip": "Select 'Yes' to configure Custom DNS Alias based on an existing Azure DNS Zone. Select 'No' to create an Azure DNS Zone and Custom DNS Alias.",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Yes",
                                            "value": true
                                        },
                                        {
                                            "label": "No",
                                            "value": false
                                        }
                                    ]
                                },
                                "visible": "[steps('section_appGateway').dnsConfiguration.enableDNSConfiguration]"
                            },
                            {
                                "name": "dnszoneName",
                                "type": "Microsoft.Common.TextBox",
                                "label": "DNS Zone Name",
                                "defaultValue": "",
                                "toolTip": "Use only letters and numbers and periods to separate Domains",
                                "constraints": {
                                    "required": true,
                                    "regex": "^([0-9a-zA-Z_-]{1,63}\\.){1,33}[0-9a-zA-Z_-]{1,63}$",
                                    "validationMessage": "There must be between 2 and 34 labels. For example, \"contoso.com\" has 2 labels. Each label must contain between 1 and 63 characters. Each label must only contain letters, numbers, underscores, and dashes."
                                },
                                "visible": "[steps('section_appGateway').dnsConfiguration.enableDNSConfiguration]"
                            },
                            {
                                "name": "dnsZoneResourceGroup",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Name of the resource group contains the DNS Zone in current subscription",
                                "defaultValue": "",
                                "toolTip": "Name of the resource group which contains the DNS Zone in current subscription",
                                "constraints": {
                                    "required": true,
                                    "regex": "^[a-z0-9A-Z.\\-_()]{0,89}([a-z0-9A-Z\\-_()]{1})$",
                                    "validationMessage": "[if(greater(length(steps('section_appGateway').dnsConfiguration.dnsZoneResourceGroup), 90),'Resource group names only allow up to 90 characters.', 'Resource group names only allow alphanumeric characters, periods, underscores, hyphens and parenthesis and cannot end in a period.')]"
                                },
                                "visible": "[and(steps('section_appGateway').dnsConfiguration.enableDNSConfiguration,steps('section_appGateway').dnsConfiguration.bringDNSZone)]"
                            },
                            {
                                "name": "dnszoneAdminConsoleLabel",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Label for Oracle WebLogic Administration Console",
                                "defaultValue": "admin",
                                "toolTip": "Specify a label to generate subdomain of Oracle WebLogic Administration Console",
                                "constraints": {
                                    "required": true,
                                    "validations": [
                                        {
                                            "regex": "^([0-9a-zA-Z_-]{1,63}\\.){0,33}[0-9a-zA-Z_-]{1,63}$",
                                            "message": "Each label must contain between 1 and 63 characters. Each label must only contain letters, numbers, underscores, and dashes."
                                        },
                                        {
                                            "isValid": "[less(sub(length(concat(steps('section_appGateway').dnsConfiguration.dnszoneAdminConsoleLabel,'.',steps('section_appGateway').dnsConfiguration.dnszoneName)),length(replace(concat(steps('section_appGateway').dnsConfiguration.dnszoneAdminConsoleLabel,'.',steps('section_appGateway').dnsConfiguration.dnszoneName), '.', ''))),34)]",
                                            "message": "Subdomain must be between 2 and 34 labels. For example, \"admin.contoso.com\" has 3 labels."
                                        }
                                    ]
                                },
                                "visible": "[steps('section_appGateway').dnsConfiguration.enableDNSConfiguration]"
                            },
                            {
                                "name": "dnszoneGatewayLabel",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Label for WebLogic Cluster",
                                "defaultValue": "www",
                                "toolTip": "Specify a label to generate subdomain of WebLogic Cluster",
                                "constraints": {
                                    "required": true,
                                    "validations": [
                                        {
                                            "regex": "^([0-9a-zA-Z_-]{1,63}\\.){0,33}[0-9a-zA-Z_-]{1,63}$",
                                            "message": "Each label must contain between 1 and 63 characters. Each label must only contain letters, numbers, underscores, and dashes."
                                        },
                                        {
                                            "isValid": "[less(sub(length(concat(if(empty(steps('section_appGateway').dnsConfiguration.dnszoneGatewayLabel), '', steps('section_appGateway').dnsConfiguration.dnszoneGatewayLabel),'.',steps('section_appGateway').dnsConfiguration.dnszoneName)),length(replace(concat(if(empty(steps('section_appGateway').dnsConfiguration.dnszoneGatewayLabel), '', steps('section_appGateway').dnsConfiguration.dnszoneGatewayLabel),'.',steps('section_appGateway').dnsConfiguration.dnszoneName), '.', ''))),34)]",
                                            "message": "Subdomain must be between 2 and 34 labels. For example, \"applications.contoso.com\" has 3 labels."
                                        }
                                    ]
                                },
                                "visible": "[steps('section_appGateway').dnsConfiguration.enableDNSConfiguration]"
                            }
                        ],
                        "visible": true
                    }
                ]
            }
        ],
        "outputs": {
            "acrName": "[last(split(steps('section_aks').acrInfo.acrSelector.id, '/'))]",
            "aksAgentPoolNodeCount": "[steps('section_aks').clusterInfo.aksNodeCount]",
            "aksClusterName": "[last(split(steps('section_aks').clusterInfo.aksClusterSelector.id, '/'))]",
            "aksClusterRGName": "[last(take(split(steps('section_aks').clusterInfo.aksClusterSelector.id, '/'), 5))]",
            "appGatewayCertificateOption": "[steps('section_appGateway').appgwIngress.certificateOption]",
            "appGatewaySSLCertData": "[steps('section_appGateway').appgwIngress.keyVaultSSLCertData]",
            "appGatewaySSLCertPassword": "[steps('section_appGateway').appgwIngress.appGatewaySSLCertPassword]",
            "appgwForAdminServer": "[steps('section_appGateway').appgwIngress.appgwForAdminServer]",
            "appPackageUrls": "[steps('section_aks').jeeAppInfo.appPackageUrl]",
            "appReplicas": "[int(steps('section_aks').jeeAppInfo.appReplicas)]",
            "createACR": "[bool(steps('section_aks').acrInfo.createACR)]",
            "createAKSCluster": "[bool(steps('section_aks').clusterInfo.createAKSCluster)]",
            "createDNSZone": "[not(bool(steps('section_appGateway').dnsConfiguration.bringDNSZone))]",
            "dnszoneAdminConsoleLabel": "[steps('section_appGateway').dnsConfiguration.dnszoneAdminConsoleLabel]",
            "dnszoneAppGatewayLabel": "[steps('section_appGateway').dnsConfiguration.dnszoneGatewayLabel]",
            "dnszoneName": "[steps('section_appGateway').dnsConfiguration.dnszoneName]",
            "dnszoneRGName": "[steps('section_appGateway').dnsConfiguration.dnsZoneResourceGroup]",
            "enableAppGWIngress": "[steps('section_appGateway').appgwIngress.enableAppGateway]",
            "enableAzureMonitoring": "[bool(steps('section_aks').clusterInfo.enableAzureMonitoring)]",
            "enableAzureFileShare": "[bool(steps('section_aks').clusterInfo.enableAzureFileShare)]",
            "enableDNSConfiguration": "[bool(steps('section_appGateway').dnsConfiguration.enableDNSConfiguration)]",
            "identity": "[basics('basicsRequired').identity]",
            "lbSvcValues": "[steps('section_appGateway').lbSVCInfo.lbSVC]",
            "location": "[location()]",
            "keyVaultName": "[steps('section_appGateway').appgwIngress.keyVaultName]",
            "keyVaultResourceGroup": "[steps('section_appGateway').appgwIngress.keyVaultResourceGroup]",
            "keyVaultSSLCertDataSecretName": "[steps('section_appGateway').appgwIngress.keyVaultSSLCertDataSecretName]",
            "keyVaultSSLCertPasswordSecretName": "[steps('section_appGateway').appgwIngress.keyVaultSSLCertPasswordSecretName]",
            "managedServerPrefix": "[basics('basicsOptional').managedServerPrefix]",
            "ocrSSOPSW": "[basics('basicsRequired').ocrSSOPassword]",
            "ocrSSOUser": "[basics('basicsRequired').ocrSSOUserName]",
            "servicePrincipal": "[steps('section_appGateway').appgwIngress.servicePrincipal]",
            "uploadAppPackage": "[bool(steps('section_aks').jeeAppInfo.uploadAppPackage)]",
            "wdtRuntimePassword": "[basics('basicsRequired').wdtRuntimePassword]",
            "wlsClusterSize": "[basics('basicsOptional').wlsClusterSize]",
            "wlsDomainName": "[basics('basicsOptional').wlsDomainName]",
            "wlsDomainUID": "[basics('basicsOptional').wlsDomainUID]",
            "wlsImageTag": "[steps('section_aks').imageInfo.fromImage]",
            "wlsPassword": "[basics('basicsRequired').wlsPassword]",
            "wlsUserName": "[basics('basicsRequired').wlsUserName]"
        }
    }
}